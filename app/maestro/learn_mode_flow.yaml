appId: com.namedrill.namedrill
---
# NameDrill - Learn Mode Complete Flow Test
# 
# Tests the FULL Learn Mode experience - all 10 cards
# Uses TEST_MODE which auto-seeds data and skips onboarding
#
# Note: Uses coordinate-based taps for flashcard since Flutter's 
# Semantics can hide nested text from accessibility tree.
#
# Build with: ~/flutter/bin/flutter build apk --debug --dart-define=TEST_MODE=true
# Then: ~/.maestro/bin/maestro test maestro/learn_mode_flow.yaml

- launchApp:
    clearState: true

# ==========================================
# Home Screen
# ==========================================

- extendedWaitUntil:
    visible: "NameDrill"
    timeout: 20000

- extendedWaitUntil:
    visible: "Test Group"
    timeout: 15000

- tapOn:
    text: "Test Group"
    index: 0

# ==========================================
# Group Detail Screen
# ==========================================

- extendedWaitUntil:
    visible: "Learn"
    timeout: 10000

- tapOn: "Learn"

# ==========================================
# Learn Mode - Complete all 10 cards
# ==========================================

# Card 1
- extendedWaitUntil:
    visible:
      text: "1 / \\d+"
    timeout: 15000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Got It"
    timeout: 10000
- tapOn: "Got It"

# Card 2
- extendedWaitUntil:
    visible:
      text: "2 / \\d+"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Forgot"
    timeout: 8000
- tapOn: "Forgot"

# Card 3
- extendedWaitUntil:
    visible:
      text: "3 / \\d+"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Got It"
    timeout: 8000
- tapOn: "Got It"

# Card 4
- extendedWaitUntil:
    visible:
      text: "4 / \\d+"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Got It"
    timeout: 8000
- tapOn: "Got It"

# Card 5
- extendedWaitUntil:
    visible:
      text: "5 / \\d+"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Forgot"
    timeout: 8000
- tapOn: "Forgot"

# Card 6
- extendedWaitUntil:
    visible:
      text: "6 / \\d+"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Got It"
    timeout: 8000
- tapOn: "Got It"

# Card 7
- extendedWaitUntil:
    visible:
      text: "7 / \\d+"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Got It"
    timeout: 8000
- tapOn: "Got It"

# Card 8
- extendedWaitUntil:
    visible:
      text: "8 / \\d+"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Got It"
    timeout: 8000
- tapOn: "Got It"

# Card 9
- extendedWaitUntil:
    visible:
      text: "9 / \\d+"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Got It"
    timeout: 8000
- tapOn: "Got It"

# Card 10 (last)
- extendedWaitUntil:
    visible:
      text: "10 / 10"
    timeout: 8000
- tapOn:
    point: "50%, 50%"
- extendedWaitUntil:
    visible: "Got It"
    timeout: 8000
- tapOn: "Got It"

# ==========================================
# Session Complete - Verify Summary
# ==========================================

- extendedWaitUntil:
    visible: "Session Complete"
    timeout: 10000

# Verify stats are shown
- assertVisible: "Cards"
- assertVisible: "Accuracy"
- assertVisible: "Correct"

# Should show "Focus on these" since we marked some as Forgot
- assertVisible: "Focus on these"

# Complete and return to group detail
- tapOn: "Done"

- extendedWaitUntil:
    visible: "Test Group"
    timeout: 10000

- assertVisible: "Learn"
